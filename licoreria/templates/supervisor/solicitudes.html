{% extends 'base.html' %}

{% block title %}Solicitudes de Préstamo | Supervisor{% endblock %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
    <div>
        <h2 style="margin: 0; display: flex; align-items: center; gap: 0.8rem;">
            <i class="ph ph-bell-ringing" style="color: var(--accent-primary);"></i>
            Solicitudes de Préstamo Pendientes
        </h2>
        <p style="color: #64748b; margin: 0.5rem 0 0 0;">Gestione las solicitudes de crédito enviadas por los clientes.
        </p>
    </div>
    <a href="{% url 'index' %}" class="btn btn-secondary">← Volver</a>
</div>

<div
    style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05); border-radius: 16px; overflow: hidden;">
    <table style="width: 100%; border-collapse: collapse;">
        <thead>
            <tr style="background: rgba(255,255,255,0.02); text-align: left;">
                <th style="padding: 1.2rem; color: #94a3b8;">CÓDIGO</th>
                <th style="padding: 1.2rem; color: #94a3b8;">CLIENTE</th>
                <th style="padding: 1.2rem; color: #94a3b8;">FECHA</th>
                <th style="padding: 1.2rem; color: #94a3b8;">TOTAL</th>
                <th style="padding: 1.2rem; text-align: right; color: #94a3b8;">ACCIONES</th>
            </tr>
        </thead>
        <tbody>
            {% for sol in solicitudes %}
            <tr style="border-bottom: 1px solid rgba(255,255,255,0.05); transition: background 0.3s;"
                onmouseover="this.style.background='rgba(255,255,255,0.02)'"
                onmouseout="this.style.background='transparent'">
                <td style="padding: 1.2rem; font-family: monospace; font-weight: bold; color: var(--accent-primary);">
                    #{{ sol.codigo_orden }}</td>
                <td style="padding: 1.2rem;">
                    <div style="display: flex; flex-direction: column;">
                        <span style="font-weight: 600;">{{ sol.cliente.nombre }}</span>
                        <small style="color: #64748b;">{{ sol.cliente.email }}</small>
                    </div>
                </td>
                <td style="padding: 1.2rem; color: #cbd5e1;">{{ sol.fecha|date:"d M Y - H:i" }}</td>
                <td style="padding: 1.2rem; font-weight: bold; color: #34d399;">${{ sol.total|floatformat:2 }}</td>
                <td style="padding: 1.2rem; text-align: right;">
                    <div style="display: flex; justify-content: flex-end; gap: 0.5rem;">
                        <a href="{% url 'detalle_orden' sol.id %}" class="btn btn-sm btn-outline-primary"
                            style="padding: 0.5rem 0.8rem;">
                            <i class="ph ph-eye"></i>
                        </a>
                        <form action="{% url 'gestion_solicitudes' %}" method="POST" style="display: inline;">
                            {% csrf_token %}
                            <input type="hidden" name="orden_id" value="{{ sol.id }}">
                            <button name="accion" value="aprobar" class="btn btn-sm btn-primary"
                                style="padding: 0.5rem 1rem;">
                                <i class="ph ph-check-circle"></i> Aprobar
                            </button>
                            <button name="accion" value="rechazar" class="btn btn-sm btn-outline-danger"
                                style="padding: 0.5rem 1rem;">
                                <i class="ph ph-x-circle"></i> Rechazar
                            </button>
                        </form>
                    </div>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" style="padding: 4rem; text-align: center;">
                    <i class="ph ph-file-search"
                        style="font-size: 3rem; color: #1e293b; display: block; margin-bottom: 1rem;"></i>
                    <span style="color: #64748b;">No hay solicitudes de préstamo pendientes.</span>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}