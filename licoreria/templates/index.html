{% extends 'base.html' %}

{% block header_title %}Resumen General{% endblock %}

{% block extra_css %}
.stats-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
gap: 1.5rem;
margin-bottom: 2rem;
}

.stat-card {
background: var(--bg-sidebar);
padding: 1.5rem;
border-radius: 16px;
border: 1px solid var(--border);
display: flex;
align-items: center;
gap: 1rem;
transition: transform 0.2s;
}

.stat-card:hover {
transform: translateY(-3px);
border-color: var(--accent);
}

.stat-icon {
width: 50px;
height: 50px;
border-radius: 12px;
background: rgba(139, 92, 246, 0.1);
color: var(--accent);
display: flex;
align-items: center;
justify-content: center;
font-size: 1.5rem;
}

.stat-info h3 {
margin: 0;
font-size: 1.5rem;
font-weight: 700;
}

.stat-info p {
margin: 0;
font-size: 0.85rem;
color: var(--text-secondary);
}

.quick-actions-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
gap: 1.5rem;
}

.action-card {
background: var(--bg-card);
padding: 2rem;
border-radius: 16px;
text-align: center;
text-decoration: none;
color: white;
border: 1px solid var(--border);
transition: all 0.2s;
}

.action-card:hover {
background: var(--bg-sidebar);
border-color: var(--accent);
}

.action-card i {
font-size: 2rem;
margin-bottom: 1rem;
color: var(--accent);
display: block;
}
{% endblock %}

{% block content %}
<!-- Tarjetas de Estadísticas (Ficticias por ahora, se pueden conectar a backend) -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-icon"><i class="ph ph-currency-dollar"></i></div>
        <div class="stat-info">
            <h3>${{ ventas_hoy }}</h3>
            <p>Ventas Hoy</p>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon"><i class="ph ph-shopping-bag"></i></div>
        <div class="stat-info">
            <h3>{{ pedidos_nuevos }}</h3>
            <p>Pedidos Nuevos</p>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon"><i class="ph ph-users"></i></div>
        <div class="stat-info">
            <h3>{{ clientes_activos }}</h3>
            <p>Clientes Registrados</p>
        </div>
    </div>
    <div class="stat-card">
        <div class="stat-icon"><i class="ph ph-package"></i></div>
        <div class="stat-info">
            <h3>{{ productos_stock }}</h3>
            <p>Unidades en Stock</p>
        </div>
    </div>
</div>

<div
    style="background: var(--bg-sidebar); border-radius: 16px; padding: 1.5rem; margin-bottom: 2rem; border: 1px solid var(--border);">
    <h3 style="margin: 0 0 1.5rem 0; font-size: 1.1rem; font-weight: 600;">Historial de Ventas (Últimos 7 días)</h3>
    <div style="height: 300px; width: 100%;">
        <canvas id="salesChart"></canvas>
    </div>
</div>

{{ chart_labels|json_script:"chart-labels-data" }}
{{ chart_data|json_script:"chart-data-data" }}

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const ctx = document.getElementById('salesChart').getContext('2d');

        // Parse data from Django json_script tags
        const chartLabels = JSON.parse(document.getElementById('chart-labels-data').textContent);
        const chartData = JSON.parse(document.getElementById('chart-data-data').textContent);

        const salesChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: chartLabels,
                datasets: [{
                    label: 'Ventas ($)',
                    data: chartData,
                    borderColor: '#8b5cf6',
                    backgroundColor: 'rgba(139, 92, 246, 0.1)',
                    borderWidth: 2,
                    tension: 0.4,
                    fill: true,
                    pointBackgroundColor: '#8b5cf6'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(255, 255, 255, 0.05)'
                        },
                        ticks: {
                            color: '#94a3b8'
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        },
                        ticks: {
                            color: '#94a3b8'
                        }
                    }
                }
            }
        });
    });
</script>

<h3 style="margin-bottom: 1.5rem; font-weight: 600;">Accesos Rápidos</h3>
<div class="quick-actions-grid">
    <a href="{% url 'productos' %}" class="action-card">
        <i class="ph ph-plus-circle"></i>
        <span>Nuevo Producto</span>
    </a>
    <a href="{% url 'clientes' %}" class="action-card">
        <i class="ph ph-user-plus"></i>
        <span>Registrar Cliente</span>
    </a>
    <a href="{% url 'gastos' %}" class="action-card">
        <i class="ph ph-receipt"></i>
        <span>Reportar Gasto</span>
    </a>
    <a href="{% url 'ordenes' %}" class="action-card">
        <i class="ph ph-clock-counter-clockwise"></i>
        <span>Historial</span>
    </a>
</div>
{% endblock %}