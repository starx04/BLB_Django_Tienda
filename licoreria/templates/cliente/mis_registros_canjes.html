{% extends 'base.html' %}

{% block title %}Mis Canjes | Licorería BLB{% endblock %}

{% block extra_css %}
<style>
    .registry-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem 1rem;
    }

    .premium-card {
        background: rgba(15, 15, 15, 0.6);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.05);
        border-radius: 24px;
        padding: 2rem;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
    }

    .premium-table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0 12px;
    }

    .premium-table thead th {
        padding: 1rem 1.5rem;
        color: var(--accent-primary);
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-size: 0.75rem;
        border-bottom: 2px solid rgba(255, 255, 255, 0.05);
    }

    .premium-table tbody tr {
        background: rgba(255, 255, 255, 0.02);
        transition: all 0.3s ease;
    }

    .premium-table tbody tr:hover {
        background: rgba(var(--accent-rgb), 0.05);
        transform: scale(1.01);
    }

    .premium-table tbody td {
        padding: 1.2rem 1.5rem;
        vertical-align: middle;
        border-top: 1px solid rgba(255, 255, 255, 0.03);
        border-bottom: 1px solid rgba(255, 255, 255, 0.03);
    }

    .premium-table tbody tr td:first-child {
        border-left: 1px solid rgba(255, 255, 255, 0.03);
        border-top-left-radius: 12px;
        border-bottom-left-radius: 12px;
    }

    .premium-table tbody tr td:last-child {
        border-right: 1px solid rgba(255, 255, 255, 0.03);
        border-top-right-radius: 12px;
        border-bottom-right-radius: 12px;
    }

    .badge-status {
        padding: 6px 14px;
        border-radius: 8px;
        font-weight: 800;
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        display: inline-block;
    }

    .status-used {
        background: #64748b;
        color: white;
        box-shadow: 0 0 10px rgba(100, 116, 139, 0.3);
    }

    .status-pending {
        background: #f59e0b;
        color: black;
        box-shadow: 0 0 10px rgba(245, 158, 11, 0.3);
    }

    .status-approved {
        background: var(--accent-success);
        color: black;
        box-shadow: 0 0 15px rgba(var(--accent-rgb), 0.4);
    }

    .status-delivered {
        background: var(--accent-primary);
        color: black;
        box-shadow: 0 0 15px rgba(var(--accent-rgb), 0.4);
    }

    .status-rejected {
        background: var(--accent-danger);
        color: white;
        box-shadow: 0 0 10px rgba(239, 68, 68, 0.3);
    }

    .code-pill {
        font-family: 'Outfit', sans-serif;
        font-weight: 700;
        background: rgba(var(--accent-rgb), 0.1);
        color: var(--accent-primary);
        padding: 5px 12px;
        border-radius: 20px;
        border: 1px solid rgba(var(--accent-rgb), 0.2);
    }

    .btn-back {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        color: white;
        padding: 0.8rem 1.5rem;
        border-radius: 12px;
        text-decoration: none;
        font-weight: 700;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 10px;
    }

    .btn-back:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: translateX(-5px);
    }
</style>
{% endblock %}

{% block content %}
<div class="registry-container">
    <div style="margin-bottom: 2.5rem;">
        <h1 style="font-size: 2.5rem; font-weight: 900; margin-bottom: 0.5rem; color: white;">
            Mis Registros de <span style="color: var(--accent-primary);">Canjes</span>
        </h1>
        <p style="color: var(--text-secondary);">Historial detallado de tus recompensas y beneficios utilizados.</p>
    </div>

    <div class="premium-card">
        <table class="premium-table">
            <thead>
                <tr>
                    <th>Código</th>
                    <th>Recompensa</th>
                    <th style="text-align: center;">Costo Puntos</th>
                    <th style="text-align: center;">Estado</th>
                    <th style="text-align: right;">Fecha</th>
                </tr>
            </thead>
            <tbody>
                {% for canje in recompensas %}
                <tr>
                    <td>
                        {% if canje.codigo_canje %}
                        <span class="code-pill">{{ canje.codigo_canje }}</span>
                        {% else %}
                        <span style="color: var(--text-secondary);">-</span>
                        {% endif %}
                    </td>
                    <td>
                        <div style="font-weight: 600; color: white;">{{ canje.descripcion }}</div>
                        <div style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 4px;">{{
                            canje.get_tipo_display }}</div>
                    </td>
                    <td style="text-align: center;">
                        <span style="color: var(--accent-warning); font-weight: 700;">{{ canje.costo_puntos }}
                            pts</span>
                    </td>
                    <td style="text-align: center;">
                        {% if canje.utilizada %}
                        <span class="badge-status status-used">Utilizado</span>
                        {% else %}
                        {% if canje.estado_solicitud == 'PEND' %}
                        <span class="badge-status status-pending">Pendiente</span>
                        {% elif canje.estado_solicitud == 'APROB' %}
                        <span class="badge-status status-approved">Disponible</span>
                        {% elif canje.estado_solicitud == 'ENTR' %}
                        <span class="badge-status status-delivered">Entregado</span>
                        {% elif canje.estado_solicitud == 'RECH' %}
                        <span class="badge-status status-rejected">Rechazada</span>
                        {% endif %}
                        {% endif %}
                    </td>
                    <td style="text-align: right; color: var(--text-secondary); font-size: 0.9rem;">
                        {{ canje.fecha_solicitud|date:"d M Y" }}
                        <div style="font-size: 0.75rem; opacity: 0.7;">{{ canje.fecha_solicitud|date:"H:i" }}</div>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" style="text-align: center; padding: 4rem; color: var(--text-secondary);">
                        <i class="ph ph-ticket"
                            style="font-size: 3rem; opacity: 0.2; display: block; margin-bottom: 1rem;"></i>
                        Aún no tienes registros de canjes realizados.
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div style="margin-top: 2rem;">
        <a href="{% url 'panel_fidelidad' %}" class="btn-back">
            <i class="ph ph-arrow-left"></i> VOLVER AL PANEL
        </a>
    </div>
</div>
{% endblock %}